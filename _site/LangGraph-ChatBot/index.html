<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>LangGraph-ChatBot | Carson’s Meditations</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="LangGraph-ChatBot" />
<meta name="author" content="Carson Kempf" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tool-Augmented Chatbot: System Overview" />
<meta property="og:description" content="Tool-Augmented Chatbot: System Overview" />
<link rel="canonical" href="https://carsontkempf.github.io/LangGraph-ChatBot/" />
<meta property="og:url" content="https://carsontkempf.github.io/LangGraph-ChatBot/" />
<meta property="og:site_name" content="Carson’s Meditations" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-15T11:46:10-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="LangGraph-ChatBot" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Carson Kempf"},"dateModified":"2025-05-15T11:46:10-06:00","datePublished":"2025-05-15T11:46:10-06:00","description":"Tool-Augmented Chatbot: System Overview","headline":"LangGraph-ChatBot","mainEntityOfPage":{"@type":"WebPage","@id":"https://carsontkempf.github.io/LangGraph-ChatBot/"},"url":"https://carsontkempf.github.io/LangGraph-ChatBot/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=b4a6cf313c17d87e16de50d0a09fa0c58770e3e7">
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- Load Auth0 SPA SDK deferred to avoid issues with document.write and improve performance -->
    <script defer src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
    <script>
      (function() {
        var theme = localStorage.getItem('theme');
        if (theme && theme !== 'light') {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>

  </head>
  <body>
    <div class="theme-switch">
    <input type="radio" id="ts-light" name="theme" value="light" checked>
    <input type="radio" id="ts-dark" name="theme" value="dark">
    <input type="radio" id="ts-lr" name="theme" value="lr">
    <div class="slider"></div>
    <label for="ts-light" class="opt"></label>
    <label for="ts-dark" class="opt"></label>
    <label for="ts-lr" class="opt"></label>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var saved = localStorage.getItem('theme') || 'light';
      var radio = document.getElementById('ts-' + saved);
      if (radio) radio.checked = true;
      document.documentElement.setAttribute('data-theme', saved);
    });
    document.querySelectorAll('.theme-switch input').forEach(function(input) {
      input.addEventListener('change', function() {
        var mode = this.value;
        document.documentElement.setAttribute('data-theme', mode);
        localStorage.setItem('theme', mode);
      });
    });
  </script>
    <div class="wrapper">
      <!-- Header Section -->
      <aside class="header">
        <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DSMK52452T"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DSMK52452T');
  </script>


<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<header>
  <h1>
    <a href="/">Carson's Meditations</a>
  </h1>

  

  <p class="skinny">
    My site for my reflections on all types of projects
  </p>

  <p class="view">
    <a href="/resume">Check Out My Resume</a>
  </p>

  
  
    <p>
      <a href="https://github.com/carsontkempf">View My GitHub Profile</a>
    </p>
  
</header>

<!-- end custom head snippets -->
      </aside>
      <aside class="sidebar">
        <div class="sidebar skinny">

    

    <h2>LangChain</h2>

  <ol>
    <ul>
      
        <li><a href="/LangChain-With-Search/">LangChain-With-Search</a></li>
      
        <li><a href="/LangChain-Tools/">LangChain-Tools</a></li>
      
        <li><a href="/LangChain-Conceptual-Guide/">LangChain-Conceptual-Guide</a></li>
      
        <li><a href="/LangChain/">LangChain Overview</a></li>
      
    </ul>
  </ol>


    

    <h2>AI</h2>

  <ol>
    <ul>
      
        <li><a href="/Computer-Chess-Program/">Computer-Chess-Program</a></li>
      
        <li><a href="/Chess-Program/">Chess-Program</a></li>
      
        <li><a href="/Chess-Program-Requirements/">Chess-Program-Requirements</a></li>
      
        <li><a href="/River-Toad-Game/">River-Toad-Game</a></li>
      
        <li><a href="/A-Star-Search-Assignment/">A-Star-Search-Assignment</a></li>
      
    </ul>
  </ol>


    

    <h2>Apps</h2>

  <ol>
    <ul>
      
        <li><a href="/LangGraph-ChatBot/">LangGraph-ChatBot</a></li>
      
        <li><a href="/To-Do-App/">To-Do-App</a></li>
      
    </ul>
  </ol>


    

    <h2>Extensions</h2>

  <ol>
    <ul>
      
        <li><a href="/Chrome-Extension/">Chrome-Extension</a></li>
      
        <li><a href="/VSCode-Extension/">VSCode-Extension</a></li>
      
    </ul>
  </ol>


    
</div>
      </aside>
      <!-- Body Section -->
      <section class="main-content">
        <small>15 May 2025</small>
<h1>LangGraph-ChatBot</h1>

<p class="view">by Carson Kempf</p>

<h1 id="tool-augmented-chatbot-system-overview">Tool-Augmented Chatbot: System Overview</h1>

<h2 id="chapter-1-user-interaction---the-chat-interface">Chapter 1: User Interaction - The Chat Interface</h2>

<p>A user interacts with the Chatbot through a web-based interface. The user types their query into a text input field and submits it.</p>

<p>This interface is built using <strong>Streamlit</strong> (as seen in <code class="language-plaintext highlighter-rouge">visuals.py</code>).</p>

<h3 id="what-is-streamlit">What is Streamlit?</h3>

<p>Streamlit is a Python library that simplifies the creation of web applications. For developers, it’s a way to build interactive user interfaces using Python code, without needing extensive web development knowledge (HTML, CSS, JavaScript). Streamlit handles the complexities of rendering web elements, allowing developers to focus on the application’s logic and functionality.</p>

<p>In this project, <code class="language-plaintext highlighter-rouge">visuals.py</code> uses Streamlit to:</p>
<ul>
  <li>Display the application title (e.g., “LLM Chat with Tool Routing”) via <code class="language-plaintext highlighter-rouge">display_title()</code>.</li>
  <li>Provide a text area for user input via <code class="language-plaintext highlighter-rouge">get_user_input()</code>.</li>
  <li>Include a “Submit” button to send the query.</li>
  <li>Offer a selection widget for choosing the underlying Large Language Model (LLM), such as DeepSeek or Claude.</li>
</ul>

<p><img src="../assets/img/2025-05-16-10-39-04.png" alt="" /></p>

<h2 id="chapter-2-core-logic---langgraph-orchestration">Chapter 2: Core Logic - LangGraph Orchestration</h2>

<p>When a user submits a query, it’s processed by the Chatbot’s core logic, which is managed by <strong>LangGraph</strong> (defined in <code class="language-plaintext highlighter-rouge">lang_graph.py</code>). This system uses a Large Language Model (LLM) as its central reasoning component.</p>

<h3 id="what-is-langgraph">What is LangGraph?</h3>

<p>LangGraph is a library for building stateful, multi-actor applications with LLMs. It allows developers to define complex workflows as graphs, where the LLM can decide to call upon external “tools” to gather information or perform actions.</p>

<p>Essentially, LangGraph enables the LLM to:</p>
<ol>
  <li>Analyze the user’s query and determine if it can answer directly.</li>
  <li>If not, identify if a specialized “tool” (a helper function) is needed to fulfill the request.</li>
</ol>

<p><code class="language-plaintext highlighter-rouge">lang_graph.py</code> sets up this decision-making process:</p>
<ul>
  <li>It defines an <code class="language-plaintext highlighter-rouge">AgentState</code> to maintain the history and current state of the conversation.</li>
  <li>The <code class="language-plaintext highlighter-rouge">call_model</code> function is the entry point where the LLM first processes the user’s message.</li>
  <li>The LLM is made aware of available tools (via <code class="language-plaintext highlighter-rouge">core_llm.bind_tools(available_tools)</code>). For instance, if a user asks, “What’s the weather in Paris?”, the LLM can recognize the need for the <code class="language-plaintext highlighter-rouge">weather_tool</code>.</li>
  <li>LangGraph uses a <code class="language-plaintext highlighter-rouge">ToolNode</code> to execute the chosen tool.</li>
  <li>The <code class="language-plaintext highlighter-rouge">tools_condition</code> acts as a conditional router: if a tool is selected by the LLM, the workflow executes that tool; otherwise, the LLM might proceed to generate a direct answer.</li>
  <li>The system includes a mechanism to prevent redundant tool calls. If a tool (e.g., <code class="language-plaintext highlighter-rouge">weather_tool</code>) has just been executed with specific arguments, and the LLM proposes to call the exact same tool with the exact same arguments again, this redundant call is suppressed to enhance efficiency.</li>
</ul>

<p>The compiled workflow (<code class="language-plaintext highlighter-rouge">workflow.compile()</code>) results in an intelligent agent capable of dynamic decision-making and tool utilization.</p>

<h2 id="chapter-3-specialized-capabilities---the-tools">Chapter 3: Specialized Capabilities - The Tools</h2>

<p>The LLM, orchestrated by LangGraph, can leverage a suite of specialized tools to perform specific tasks or retrieve external information. These tools are individual Python functions designed for particular purposes:</p>

<ul>
  <li>
    <p><strong>Professor Defini (<code class="language-plaintext highlighter-rouge">define_tool.py</code>):</strong>
    *   <strong>Functionality:</strong> Provides definitions for terms or concepts.
    *   <strong>Mechanism:</strong> When asked to define something (e.g., “Define ‘artificial intelligence’”), this tool uses an LLM to generate a concise definition.</p>
  </li>
  <li>
    <p><strong>Weather Wiz (<code class="language-plaintext highlighter-rouge">weather.py</code>):</strong>
    *   <strong>Functionality:</strong> Retrieves current weather information for a specified location.
    *   <strong>Mechanism:</strong> For a query like “What’s the weather like in Rolla, MO tonight?”, this tool first uses the Nominatim service to geocode the location (find its latitude and longitude). It then queries the National Weather Service (NWS) API to fetch the weather forecast. It includes error handling for network issues or unresolvable locations.</p>
  </li>
  <li>
    <p><strong>News Hound (<code class="language-plaintext highlighter-rouge">web_search.py</code>):</strong>
    *   <strong>Functionality:</strong> Performs web searches to find current information or news.
    *   <strong>Mechanism:</strong> For queries like “What’s the latest news about self-driving cars?”, this tool uses the Tavily search API to find relevant web pages and returns a summary of the search results.</p>
  </li>
  <li>
    <p><strong>Speedy Summarizer (<code class="language-plaintext highlighter-rouge">summarizer.py</code>):</strong>
    *   <strong>Functionality:</strong> Condenses long pieces of text into shorter summaries.
    *   <strong>Mechanism:</strong> If provided with a lengthy text, this tool will summarize it to a specified maximum word count (e.g., 150 words), extracting the key information.</p>
  </li>
</ul>

<p>These tools act as specialized assistants, providing the LLM with capabilities beyond its inherent knowledge. The system is extensible, allowing for the addition of new tools as needed.</p>

<h2 id="chapter-4-processing-a-query---from-input-to-output">Chapter 4: Processing a Query - From Input to Output</h2>

<p>Here’s a simplified flow of how a user query like “What’s the weather like in London?” is processed:</p>

<ol>
  <li><strong>User Input:</strong> The user types the query into the Streamlit interface (<code class="language-plaintext highlighter-rouge">visuals.py</code>).</li>
  <li><strong>LangGraph Receives:</strong> The <code class="language-plaintext highlighter-rouge">agent_graph</code> in <code class="language-plaintext highlighter-rouge">lang_graph.py</code> takes the message.</li>
  <li><strong>LLM Decision:</strong> The LLM, as part of the <code class="language-plaintext highlighter-rouge">call_model</code> function, analyzes the query and determines that the <code class="language-plaintext highlighter-rouge">weather_tool</code> is required.</li>
  <li><strong>Tool Execution:</strong> LangGraph routes the request to the <code class="language-plaintext highlighter-rouge">ToolNode</code>, which executes the <code class="language-plaintext highlighter-rouge">weather_tool</code>.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">weather_tool</code> Action (<code class="language-plaintext highlighter-rouge">weather.py</code>):</strong>
    <ul>
      <li>Finds London’s geographical coordinates.</li>
      <li>Fetches weather data from the NWS API.</li>
      <li>Returns the weather information (e.g., “London: Mostly cloudy, 15°C (as of 2023-10-27 14:00:00 UTC)”).</li>
    </ul>
  </li>
  <li><strong>Response Generation:</strong> The weather information is passed back to the LLM via LangGraph.</li>
  <li><strong>LLM Formulates Reply:</strong> The LLM uses this information to craft a user-friendly response, such as “The weather in London is currently mostly cloudy at 15°C.”</li>
  <li><strong>Display to User:</strong> Streamlit displays the final answer in the chat interface.</li>
</ol>

<h2 id="chapter-5-transparency-and-debugging---visualizations-and-logs">Chapter 5: Transparency and Debugging - Visualizations and Logs</h2>

<p>The system offers features for understanding its internal operations:</p>

<p><img src="../assets/img/2025-05-16-10-32-12.png" alt="" /></p>

<ul>
  <li><strong>Tool Invocation Graph (<code class="language-plaintext highlighter-rouge">mermaid_graph.py</code>):</strong>
For queries involving tool usage, <code class="language-plaintext highlighter-rouge">visuals.py</code> can render a visual graph (using Mermaid syntax via <code class="language-plaintext highlighter-rouge">st_mermaid</code>) illustrating the sequence of tool calls and data flow. This graph helps visualize which tools were used and in what order. Text is sanitized to ensure proper rendering.</li>
</ul>

<p><img src="../assets/img/2025-05-16-10-33-29.png" alt="" /></p>

<ul>
  <li><strong>Detailed Interaction Log (<code class="language-plaintext highlighter-rouge">visuals.py</code> - <code class="language-plaintext highlighter-rouge">display_full_log</code>):</strong>
The interface can display a comprehensive log of each interaction. This log includes the user’s query, details of each tool called (name, input, output), and the final parsed response from the LLM. This provides a step-by-step record of the chatbot’s process.</li>
</ul>

<p><img src="../assets/img/2025-05-16-10-34-00.png" alt="" /></p>

<h2 id="chapter-6-quality-assurance---automated-testing-prompt_testpy">Chapter 6: Quality Assurance - Automated Testing (<code class="language-plaintext highlighter-rouge">prompt_test.py</code>)</h2>

<p>To ensure reliability and correct functionality, the Chatbot undergoes automated testing using <code class="language-plaintext highlighter-rouge">prompt_test.py</code>. This script uses Pytest and Selenium for end-to-end testing.</p>

<p>The test script performs the following key actions:</p>
<ol>
  <li><strong>Starts the Application:</strong> It programmatically starts the Streamlit application server (<code class="language-plaintext highlighter-rouge">streamlit_server</code> fixture). It includes a utility (<code class="language-plaintext highlighter-rouge">kill_process_on_port</code>) to ensure that the required port is free before starting the server.
    *   It checks for any visible error messages on the page using <code class="language-plaintext highlighter-rouge">get_error_text_if_present</code>. If errors are detected, the test fails.
    *   It verifies expected outcomes, such as ensuring that tools are invoked when appropriate (e.g., by checking that the “No tool invocation steps to graph.” message <em>does not</em> appear if a tool was expected to run).</li>
  <li><strong>Debug Support:</strong> The script can optionally keep the browser window open after a test (<code class="language-plaintext highlighter-rouge">time.sleep(60)</code>) to allow for manual inspection in case of unexpected behavior. It also streams the Streamlit server’s output (<code class="language-plaintext highlighter-rouge">stream_output</code>) for debugging purposes.</li>
</ol>

<h2 id="summary">Summary</h2>

<p>The Tool-Augmented Chatbot combines a user-friendly Streamlit interface with the powerful reasoning capabilities of an LLM orchestrated by LangGraph. By leveraging a suite of specialized tools, the Chatbot can answer a wide range of queries, retrieve external information, and perform specific tasks. Visualizations and detailed logs provide transparency into its operations, while automated testing ensures its reliability.</p>

<p>This system is designed to be an informative and helpful assistant, capable of complex interactions and adaptable to new functionalities through the addition of more tools.</p>

<hr />

<p><strong>Key Project Files:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">tests/prompt_test.py</code>: Automated end-to-end testing script.</li>
  <li><code class="language-plaintext highlighter-rouge">tests/test_queries.py</code>: Predefined queries for automated testing.</li>
  <li><code class="language-plaintext highlighter-rouge">tools/define_tool.py</code>: Tool for defining terms.</li>
  <li><code class="language-plaintext highlighter-rouge">tools/summarizer.py</code>: Tool for summarizing text.</li>
  <li><code class="language-plaintext highlighter-rouge">tools/weather.py</code>: Tool for fetching weather information.</li>
  <li><code class="language-plaintext highlighter-rouge">tools/web_search.py</code>: Tool for performing web searches.</li>
  <li><code class="language-plaintext highlighter-rouge">lang_graph.py</code>: Core LLM and tool orchestration logic using LangGraph.</li>
  <li><code class="language-plaintext highlighter-rouge">mermaid_graph.py</code>: Utility for generating Mermaid graph definitions (used by <code class="language-plaintext highlighter-rouge">visuals.py</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">visuals.py</code>: Streamlit-based user interface, including display of logs and graphs.</li>
</ul>


      </section>
      <!-- Footer Section -->
      <section class="footer">
        <footer>


</footer>
      </section>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    <div class="sidebar-toggle-btn" id="sidebar-toggle-btn" style="--icon-offset-y: -3px;">
  <span class="toggle-icon">☰</span>
</div>
<script>
  document.getElementById('sidebar-toggle-btn').addEventListener('click', function() {
    var root = document.documentElement;
    if (root.getAttribute('data-sidebar') === 'expanded') {
      root.removeAttribute('data-sidebar');
    } else {
      root.setAttribute('data-sidebar', 'expanded');
    }
  });
  // call with a number (positive or negative) to move the icon vertically
  function setIconOffset(y) {
    document.getElementById('sidebar-toggle-btn')
      .style.setProperty('--icon-offset-y', y + 'px');
  }
</script>
<style>
  .sidebar-toggle-btn .toggle-icon {
    display: inline-block;
    transform: translateY(var(--icon-offset-y));
  }
</style>

    <!-- Auth0 UI Integration -->
    <!-- /Users/ctk/Programming/VSCodeProjects/carsontkempf.github.io/_includes/auth_ui.html -->
<div id="auth-status-buttons" style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: white; padding: 5px; border: 1px solid #ccc;">
    <button id="btn-login" onclick="siteAuth.login()" style="display: none;">Log In</button>
    <p id="user-info" style="display: none; margin: 0;"></p>
    <a href="/dashboard/" id="btn-dashboard" style="display: none;">Dashboard</a>
    <button id="btn-logout" onclick="siteAuth.logout()" style="display: none;">Log Out</button>
</div>

    <!-- Your custom auth script, can remain deferred -->
    <script defer src="/assets/js/auth.js"></script>
  </body>
</html>