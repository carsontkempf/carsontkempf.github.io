---
title: Dashboard
---

<!DOCTYPE html>
<html lang="en-US" data-theme="{{ localStorage.theme | default: 'light' }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- Load Auth0 SPA SDK deferred -->
    <script defer src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
    <script>
      // Basic theme persistence
      (function() {
        var theme = localStorage.getItem('theme');
        if (theme) {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>
    
    <!-- Dashboard-specific styles -->
    <style>
      .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 0;
        border-bottom: 1px solid #eee;
        margin-bottom: 2rem;
      }
      
      .dashboard-nav {
        display: flex;
        gap: 1rem;
        align-items: center;
      }
      
      .nav-link {
        text-decoration: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        transition: background-color 0.2s;
        color: #0066cc;
        border: none;
        background: none;
        cursor: pointer;
        font-size: 1rem;
      }
      
      .nav-link:hover {
        background-color: #f0f0f0;
        text-decoration: none;
      }
      
      .logout-btn {
        background-color: #dc3545;
        color: white;
      }
      
      .logout-btn:hover {
        background-color: #c82333;
        color: white;
      }
      
      .dashboard-wrapper {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }
      
      /* Hide auth status buttons on dashboard page */
      #auth-status-buttons {
        display: none !important;
      }
      
      /* Center the theme toggle on dashboard page */
      body .theme-switch {
        left: 50% !important;
        transform: translateX(-50%) !important;
        position: fixed !important;
        top: 1rem !important;
        z-index: 1000 !important;
      }
    </style>
  </head>
  <body>
    {% include theme-switch.html %}
    <div class="dashboard-wrapper">
      <header class="dashboard-header">
        <!-- page.title will come from the page using this layout -->
        <h1>{{ page.title | default: "Dashboard" }}</h1>
        
        <!-- Navigation links -->
        <nav class="dashboard-nav">
          <a href="{{ '/resume' | relative_url }}" class="nav-link">Home</a>
          <button id="logout-btn" class="nav-link logout-btn">Logout</button>
        </nav>
        
        {% include auth0.html %}
      </header>
      <main class="dashboard-main-content">
        <!-- Specific Dashboard HTML structure -->
        <h2>Welcome to your Dashboard!</h2>
        <p>This page is only visible to authenticated users.</p>
        <div id="dashboard-content">
            <p>Loading dashboard data...</p>
        </div>

        <!-- This is where content from the page using this layout will be injected -->
        {{ content }}
      </main>
    </div>

    <!-- Your custom auth script, essential for dashboard functionality -->
    <script defer src="{{ '/assets/js/auth.js' | relative_url }}"></script>

    <!-- Inline script that populates #dashboard-content -->
    <script>
      // The script from your original /dashboard.html (page file) goes here.
      // This script will run in the context of the dashboard layout.
      document.addEventListener('DOMContentLoaded', async () => {
          console.log('[Dashboard Layout Script] Page loaded. Checking auth status via siteAuth.');
      
          function waitForSiteAuthData() {
              return new Promise((resolve, reject) => {
                  const timeout = setTimeout(() => {
                      document.removeEventListener('siteAuthReady', listener);
                      console.error('[Dashboard Layout Script] Timeout! siteAuthReady event not received.');
                      reject(new Error("siteAuthReady event timed out."));
                  }, 7000); // Wait up to 7 seconds for the event
                  const listener = (event) => {
                      clearTimeout(timeout);
                      document.removeEventListener('siteAuthReady', listener);
                      console.log('[Dashboard Layout Script] siteAuthReady event received.');
                      resolve(event.detail); // event.detail contains window.siteAuth
                  };
                  document.addEventListener('siteAuthReady', listener);
                  // Also check if auth.js might have already fired it if this script runs late
                  if (window.siteAuth && typeof window.siteAuth.isAuthenticated === 'boolean' && window.siteAuth.auth0Client) {
                     // If auth.js seems to have run and set things up, try resolving immediately.
                     // This is a fallback, the event is preferred.
                     // Check a key property like auth0Client to ensure auth.js has done significant work.
                     console.log('[Dashboard Layout Script] siteAuth seems ready, attempting to resolve without event.');
                     listener({ detail: window.siteAuth }); // Simulate event
                  }
              });
          }
      
          try {
              const siteAuth = await waitForSiteAuthData();
      
              if (siteAuth.isAuthenticated) {
                  console.log('[Dashboard Layout Script] User is authenticated. Proceeding to load dashboard content.');
                  const dashboardContentEl = document.getElementById('dashboard-content');
                  if (dashboardContentEl) {
                    dashboardContentEl.innerHTML = `
                        <p>Hello, ${siteAuth.user ? siteAuth.user.name : 'User'}!</p>
                        <p>Your access token starts with: ${siteAuth.accessToken ? siteAuth.accessToken.substring(0, 20) + '...' : 'No token available'}</p>
                        <p>You can add subscriber-only content here.</p>
                    `;
                  }
              } else {
                  console.warn('[Dashboard Layout Script] User is NOT authenticated. This should have been handled by global redirect.');
                  const dashboardContentEl = document.getElementById('dashboard-content');
                  if (dashboardContentEl) {
                    dashboardContentEl.innerHTML = "<p>Access Denied. You should be redirected to login shortly. If not, please <a href='{{ '/login/' | relative_url }}'>click here to log in</a>.</p>";
                  }
              }
          } catch (error) {
              console.error('[Dashboard Layout Script] Error initializing dashboard:', error);
              const dashboardContentEl = document.getElementById('dashboard-content');
              if (dashboardContentEl) {
                dashboardContentEl.innerHTML = `<p>Error loading dashboard: ${error.message}</p>`;
              }
          }
      });

      // Add logout functionality
      document.getElementById('logout-btn').addEventListener('click', async () => {
          console.log('[Dashboard] Logout button clicked');
          if (window.siteAuth && window.siteAuth.auth0Client) {
              try {
                  await window.siteAuth.auth0Client.logout({
                      logoutParams: {
                          returnTo: window.location.origin
                      }
                  });
              } catch (error) {
                  console.error('[Dashboard] Error during logout:', error);
              }
          } else {
              console.warn('[Dashboard] No auth client available for logout');
              // Fallback: redirect to home
              window.location.href = '{{ "/" | relative_url }}';
          }
      });
    </script>
  </body>
</html>